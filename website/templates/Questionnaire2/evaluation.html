{% extends "base.html" %}
{% block title %}Post-Discussion Questionnaire{% endblock %}
{% block content %}
<section class="py-3 text-center container">
    <div class="row py-lg-4">
        <div class="col-lg-8 mx-auto">
            <h1 class="fw-light">Post-Discussion Questionnaire</h1>
            <p class="lead text-body-secondary">
                Now that you've had the discussion, please rate your agreement with the following statements again.
            </p>
            <p class="lead text-body-secondary">
                Topic: <b>{{ user.topic|capitalize|replace('_', ' ') }}</b>
            </p>
        </div>
    </div>
</section>

<div class="album py-3 bg-body-tertiary">
    <div class="container">
        <form action="{{ url_for('views.evaluation') }}" method="POST">
            <div class="py-3 col-md-10 rounded mx-auto p-4">
                
                <h3 class="fw-bold mt-5 mb-4">Topic-Specific Attitude (10 Questions)</h3>
                <p class="lead text-body-secondary">Please answer based on your current views after the discussion.</p>

                {# Same 10 questions as part 2, but with different field names #}
                {% set question_number = 1 %}
                {% set question_text = "I generally support the main idea or goal of this topic." %}
                {% set name_prefix = 'match_post' %}
                {% include 'opinion_slider_content.html' %}

                {% set question_number = 2 %}
                {% set question_text = "I believe the benefits of this topic outweigh its risks." %}
                {% include 'opinion_slider_content.html' %}

                {% set question_number = 3 %}
                {% set question_text = "I would personally take action in support of this issue." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 4 %}
                {% set question_text = "I think this issue has an overall positive impact on society." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 5 %}
                {% set question_text = "I believe this topic deserves more public attention." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 6 %}
                {% set question_text = "I trust the experts or authorities who promote this topic." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 7 %}
                {% set question_text = "I feel emotionally connected to this issue." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 8 %}
                {% set question_text = "I think opposing views on this topic are often based on misunderstanding." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 9 %}
                {% set question_text = "I believe addressing this issue should be a priority." %}
                {% include 'opinion_slider_content.html' %}
                
                {% set question_number = 10 %}
                {% set question_text = "I think this topic aligns with my personal values." %}
                {% include 'opinion_slider_content.html' %}

                <div class="d-grid gap-2 col-6 mx-auto mt-5">
                    <button class="btn btn-primary btn-lg" type="submit">Submit</button>
                </div>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block javascript %}
<script type="text/javascript">
    function updateSliderValue(sliderId) {
        const slider = document.getElementById(sliderId);
        const valueDisplay = document.getElementById('current-value-' + sliderId);
        if (slider && valueDisplay) {
            valueDisplay.textContent = slider.value;
        }
    }

    const sliderIds = [
        'match_post1', 'match_post2', 'match_post3', 'match_post4', 'match_post5', 
        'match_post6', 'match_post7', 'match_post8', 'match_post9', 'match_post10'
    ];

    document.addEventListener('DOMContentLoaded', () => {
        sliderIds.forEach(id => {
            const slider = document.getElementById(id);
            if (slider) {
                updateSliderValue(id);
                slider.addEventListener('input', () => updateSliderValue(id));
            }
        });
    });
</script>
{% endblock %}