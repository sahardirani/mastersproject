{% extends "base.html" %}
{% block titel %}Dialogue Platform{% endblock %}
{% block content %}

<section class="py-3 text-center container">
    <div class="row py-lg-4">
        <div class="col-lg-7 col-md-6 mx-auto">
            <h1 class="fw-light">Dialogue With the Other Side<br></h1>
        
            <p class="lead text-body-secondary">
                <br>In times of increasing polarization and online echo chambers, engaging with those 
                who think differently is essential for a healthy democratic society.
            </p>
            <p class="lead text-body-secondary">
                This platform helps you connect with someone who sees the world differently,
                in a structured and respectful setting. Before being matched, participants
                answer a few questions about political attitudes and personal background. 
                Based on this information, the system pairs you with someone who holds 
                different views on an important societal issue, such as climate activism, 
                AI and employment, or freedom of speech on social media.
            </p>
            <p class="lead text-body-secondary">
                Your conversation is structured around a short video, pre-defined questions, 
                and space for personal reflection. You will not be forced to change your views, 
                but you may gain new perspectives, understand the other side better, and contribute 
                to more constructive public debates.
            </p>
        </div>
        <div class="col-lg-5 col-md-6 mx-auto">
            <img src="{{ url_for('static', filename='Polarisation21.jpg') }}" 
                 class="rounded mx-auto mb-3" width="100%"/>
            <img src="{{ url_for('static', filename='polarization11.png') }}" 
                 class="rounded mx-auto" width="100%"/>
        </div>
    </div>

    <div class="py-3 text-center">
        <h2 class="fw-light">
            Available Discussion Topics â¬‡
        </h2>
    </div>
</section>

<style>
    .topic-image {
        width: 100%;
        height: 220px;            /* fixed height for all images */
        object-fit: cover;        /* ensures same size + cropping */
        border-radius: 8px;
    }
    .equal-card {
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    .equal-card-body {
        display: flex;
        flex-direction: column;
        justify-content: space-between; /* evenly distributes content vertically */
        height: 100%;
        padding: 1.5rem;
    }
    .equal-card-body h2 {
        min-height: 3rem;         /* ensure some space for heading */
    }
    .equal-card-body p {
        flex-grow: 1;             /* paragraph grows to fill space */
    }

    .btn-outline-primary {
    color: white;
    background: #007bff;
    border-color: #007bff;
}
.btn-outline-primary:hover{
    color: white;
    background: #0053ac;
}

@media (min-width: 992px) {
    .col-lg-6 {
        -ms-flex: 0 0 50%;
        flex: 0 0 100%;
        max-width: 75%;
    }
}
</style>

<!-- 1) SEARCH BAR BELOW THE HEADING -->
<div class="container py-3">
    <div class="row justify-content-center">
        <div class="col-12 d-flex flex-column align-items-center">

            <h4 class="fw-light mb-3 text-center">Browse &amp; Search Topics</h4>
            <p class="text-muted text-center">
                Use the search bar to quickly find one of the current discussion topics.
            </p>

            <!-- Centered search bar, 80% width -->
            <input id="topicSearch"
                   type="text"
                   class="form-control"
                   style="width: 80%; max-width: 650px;"
                   placeholder="Search topics (e.g. climate, AI, speech)...">
        </div>
    </div>
</div>


<!-- 2) THREE TOPIC CARDS -->
<div class="album py-3 bg-body-tertiary">
    <div class="container">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">

            <!-- TOPIC 1: Climate Activism -->
            <div class="col mx-auto topic-card">
                <div class="card shadow-sm equal-card">
                    <div class="card-body text-center equal-card-body">
                        <h2 class="fw-light">Climate <br>Activism</h2>
                        <img src="{{ url_for('static', filename='klimakleber1.jpg') }}" 
                             class="topic-image" />
                        <p class="card-text lead text-body-secondary mt-3">
                            Discuss the topic of climate activism and climate protests. 
                            This highly polarizing issue often evokes strong emotional reactions 
                            and differing moral perspectives.
                        </p>
                        <form action="{{ url_for('views.home') }}" method="post">
                            <input type="hidden" name="topic" value="climate">
                            <button type="submit" class="btn btn-primary">Join Discussion</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- TOPIC 2: Artificial Intelligence & Employment -->
            <div class="col mx-auto topic-card">
                <div class="card shadow-sm equal-card">
                    <div class="card-body text-center equal-card-body">
                        <h2 class="fw-light">Artificial Intelligence &amp; Employment</h2>
                        <img src="{{ url_for('static', filename='AI.jpg') }}" 
                             class="topic-image"/>
                        <p class="card-text lead text-body-secondary mt-3">
                            Explore how AI is transforming the job market. 
                            Some view AI as a threat to employment, while others argue it creates 
                            new opportunities and enhances human productivity.
                        </p>
                        <form action="{{ url_for('views.home') }}" method="post">
                            <input type="hidden" name="topic" value="ai_employment">
                            <button type="submit" class="btn btn-primary">Join Discussion</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- TOPIC 3: Freedom of Speech on Social Media -->
            <div class="col mx-auto topic-card">
                <div class="card shadow-sm equal-card">
                    <div class="card-body text-center equal-card-body">
                        <h2 class="fw-light">Freedom of Speech on Social Media</h2>
                        <img src="{{ url_for('static', filename='SM.jpg') }}" 
                             class="topic-image"/>
                        <p class="card-text lead text-body-secondary mt-3">
                            Debate the role of social media in supporting freedom of speech. 
                            Supporters believe platforms amplify marginalized voices, 
                            while critics worry about misinformation, hate speech, 
                            and algorithmic bias.
                        </p>
                        <form action="{{ url_for('views.home') }}" method="post">
                            <input type="hidden" name="topic" value="freedom_speech">
                            <button type="submit" class="btn btn-primary">Join Discussion</button>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- 3) SUGGEST A NEW TOPIC BELOW THE CARDS -->
<div class="container py-3">
    <div class="row">
        <div class="col-lg-6 mx-auto">
            <h4 class="fw-light mb-3 text-center">Suggest a New Topic</h4>
            <p class="text-muted text-center">
                Is there a topic you care about?
                Propose it here so it can be considered for future discussions.
                All suggestions will be <strong>reviewed by the moderator</strong> to ensure they align with the goals of this platform. 
                If you wish, you may also propose <strong>three discussion questions</strong> (one emotional, one argumentative, one future-oriented) 
                together with your topic description. If no questions are provided, the moderator will create them based on our dialogue framework.
            </p>


            <form method="post" action="{{ url_for('views.index') }}">
                <input type="hidden" name="form_type" value="suggest_topic">

                <div class="mb-3">
                    <label for="suggestedTitle" class="form-label">Topic title</label>
                    <input type="text"
                           class="form-control"
                           id="suggestedTitle"
                           name="title"
                           maxlength="200"
                           required>
                </div>

                <div class="mb-3">
                    <label for="suggestedDescription" class="form-label">Short description</label>
                    <textarea class="form-control"
                              id="suggestedDescription"
                              name="description"
                              rows="3"
                              required></textarea>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-outline-primary">
                        Submit topic suggestion
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Simple client-side search: hides topic cards that don't match the query
    const searchInput = document.getElementById('topicSearch');
    if (searchInput) {
        searchInput.addEventListener('input', function () {
            const query = this.value.toLowerCase();
            const cards = document.querySelectorAll('.topic-card');

            cards.forEach(card => {
                const text = card.innerText.toLowerCase();
                card.style.display = text.includes(query) ? '' : 'none';
            });
        });
    }
</script>

{% endblock %}
